<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Easemob - 简洁、直观、强悍、移动设备优先的前端开发框架，让Mobile开发更迅速、简单。" name="description">
    <meta content="Easemob" name="author">
    <title>Easemob推送 | Easemob</title>
    <link href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/docs.css" rel="stylesheet">
    <link href="http://cdn.bootcss.com/highlight.js/7.3/styles/github.min.css" rel="stylesheet">
    <style type="text/css">
      body{font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Helvetica Neue",Helvetica,Arial,"Hiragino Sans GB","Hiragino Sans GB W3","WenQuanYi Micro Hei",sans-serif;}
      h1, .h1, h2, .h2, h3, .h3, h4, .h4, .lead {font-family:"ff-tisa-web-pro-1","ff-tisa-web-pro-2","Lucida Grande","Helvetica Neue",Helvetica,Arial,"Hiragino Sans GB","Hiragino Sans GB W3","Microsoft YaHei UI","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;}
      pre code { background: transparent; }
      @media (min-width: 768px) {
          .bs-docs-home .bs-social,
          .bs-docs-home .bs-masthead-links {
            margin-left: 0;
          }
      }
    </style>
    <!--[if lt IE 9]
    script  type='text/javascript' src=("/assets/js/ie8-responsive-file-warning.js" ) 
    script  type='text/javascript' src=("http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js" ) 
    script  type='text/javascript' src=("http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js" ) -->
    <link href="/assets/ico/apple-touch-icon-144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144">
    <link href="/assets/ico/favicon.ico" rel="shortcut icon">
  </head>
  <body><a class="sr-only" href="#content"> Skip to main content</a>
<header class="navbar navbar-inverse navbar-fixed-top bs-docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target=".bs-navbar-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href=""> Easemob</a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        <li class="active">
          <a href=""> 首页</a>
        </li>
        <li>
          <a href="/quickstart/"> 入门</a>
        </li>
        <li>
          <a href="/docs/"> 文档</a>
        </li>
        <li>
          <a href="/download/"> SDK下载</a>
        </li>
        <li>
          <a href="/forum/"> 开发者论坛</a>
        </li>
        <li>
          <a href="/blog/"> 博客          </a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <a href="/signin/"> 登陆</a>
        </li>
        <li>
          <a href="/signup/"> 注册</a>
        </li>
      </ul>
    </nav>
  </div>
</header><div id="content" class="bs-header">
  <div class="container">
    <h1>
      Easemob推送
    </h1>
    <p>
      Easemob推送, 在1秒内推送上万条数据, 并且支持tag等多维度推送
    </p>
  </div>
</div>
<div class="container bs-docs-container">
  <div class="row">
    <div class="col-md-3">
      <div class="bs-sidebar hidden-print" role="complementary">
        <ul class="nav bs-sidenav">
          <li>
            <a href="#download"> 下载Bootstrap</a>
            <ul class="nav">
              <li>
                <a href="#download-compiled"> 编译后的CSS、JS和字体文件</a>
              </li>
              <li>
                <a href="#download-additional"> 额外的下载渠道</a>
              </li>
              <li>
                <a href="#download-cdn"> Bootstrap CDN</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="#whats-included"> 包含了哪些文件</a>
            <ul class="nav">
              <li>
                <a href="#whats-included-precompiled"> 编译版</a>
              </li>
              <li>
                <a href="#whats-included-source"> 源码</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="#template"> 基本模版</a>
          </li>
          <li>
            <a href="#examples"> 案例</a>
          </li>
          <li>
            <a href="#disable-responsive"> 禁用响应式布局</a>
          </li>
          <li>
            <a href="#migration"> 从2.x升级到3.0版本</a>
            <ul class="nav">
              <li>
                <a href="#migration-classes"> 被修改的主要class</a>
              </li>
              <li>
                <a href="#migration-new"> 新增class</a>
              </li>
              <li>
                <a href="#migration-dropped"> 被移除的class</a>
              </li>
              <li>
                <a href="#migration-notes"> 额外注意</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="#browsers"> 浏览器支持</a>
          </li>
          <li>
            <a href="#third-parties"> 对第三方组件的支持</a>
          </li>
          <li>
            <a href="#accessibility"> 可访问性</a>
          </li>
          <li>
            <a href="#license-faqs"> 许可证FAQ</a>
          </li>
          <li>
            <a href="#customizing"> 定制Bootstrap</a>
          </li>
        </ul>
      </div>
    </div>
    <div class="col-md-9" role="main"><p>首先, 需要明确的是, role, permission 都是api service里面的系统定义的entity, 也就是说你可以把他们当成一般的entity来操作</p>

<p>也就是意味着, 可以用</p>

<p>GET /:org/:app/roles 来查看当前app中的roles</p>

<p>GET /:org/:app/permissions 来查看当前app中定义的permissions</p>

<p>同样的也可以post等增加和修改已有的.</p>

<p>并且这些都是动态随时可以调整的, 用户每次的request请求都会经过role/permission检验, 所以一个例子是可以弄一个网页, 来让公司的管理员来自己定义role, permission, 并且让公司管理员来决定给那些员工哪些权限等等的 ( http://apigee.com/docs/usergrid/content/roles-and-permissions 这里有些图片 )</p>

<p>每个App默认都有三个role</p>

<ul>
  <li>Guest: The guest role for unauthenticated users</li>
  <li>Default: The default role for authenticated users</li>
  <li>Administrator: An empty role  </li>
</ul>

<p>(尝试一下 GET /roles)</p>

<p>可以看到每个role的name, 所以, 如同所有的entity一样, 也可以使用 /roles/default 来定位到 default role</p>

<p>也可以访问 /roles/default/permissions 来查看这个role的所有permissions</p>

<pre><code>{
  "action": "get",
  "application": "a2e433a0-ab1a-11e2-a134-85fca932f094",
  "params": {
    "_": [
      "1369886584450"
    ]
  },
  "uri": "http://api.easemob.com/easemob/qixin",
  "entities": [],
  "data": [
    "get,put,post,delete:/**"
  ],
  "timestamp": 1369886586648,
  "duration": 4,
  "organization": "easemob",
  "applicationName": "qixin"
}
</code></pre>

<p>创建一个新的role:</p>

<pre><code>post /roles {"name":"test-employee","roleName":"test-employee","title":"test-employee"} 
</code></pre>

<p>使用delete来删除一个role (和其它的entity一样)        </p>

<pre><code>delete /roles/test-employee
</code></pre>

<p>创建了这个role之后, 让我们来看看它的permission</p>

<pre><code>/roles/test-employee/permissions
</code></pre>

<p>可以看到返回结果是空的, 这个role还没有任何的permission    </p>

<p>给这个role添加permission</p>

<pre><code>   post /roles/test-employee/permissions { "permission" : "get,put,post,delete:/users/me/groups" }
</code></pre>

<p>注意, 这里的值也可以是个数组, 类似</p>

<pre><code>post /roles/test-employee/permissions { "permission" : ["get,put,post,delete:/users/me/groups","get:/**"] }       
</code></pre>

<p>可以看到返回结果 </p>

<pre><code>/roles/test-employee/permissions
 
{
  "action": "post",
  "application": "a2e433a0-ab1a-11e2-a134-85fca932f094",
  "params": {},
  "uri": "http://api.easemob.com/easemob/qixin",
  "entities": [],
  "data": [
    "get,put,post,delete:/users/me/groups"
  ],
  "timestamp": 1369887061207,
  "duration": 9,
  "organization": "easemob",
  "applicationName": "qixin"
}       
</code></pre>

<p>从一个role中删除一个permission还有点问题好像当前</p>

<p>给user设置一个role (也可以给一个group设置一个role, 然后把user添加到一个group当中)</p>

<pre><code>POST /{org_id}/{app_id}/roles/{role_id}/users/{uuid|username}

or

POST /{org_id}/{app_id}/users/{uuid|username}/roles/{role_id}
</code></pre>

<p>例如  <code>post /roles/test-employee/users/take</code> 相当于给user take赋予了 test-employee的role</p>

<p>这时候在访问 get /users/take/rolenames</p>

<pre><code>/users/take/rolenames
 
{
  "action": "get",
  "application": "a2e433a0-ab1a-11e2-a134-85fca932f094",
  "params": {
    "_": [
      "1369887953963"
    ]
  },
  "uri": "http://api.easemob.com/easemob/qixin",
  "entities": [],
  "data": {
    "test-employee": {
      "type": "role",
      "name": "test-employee",
      "roleName": null,
      "title": "test-employee",
      "inactivity": 0
    }
  },
  "timestamp": 1369887954146,
  "duration": 3,
  "organization": "easemob",
  "applicationName": "qixin"
}    
</code></pre>

<p>一个user可以有多个role的, 例如再执行一次 <code>post /roles/admin/users/take</code>, 然后调用 <code>get /users/take/rolenames</code></p>

<pre><code>/users/take/rolenames
 
{
  "action": "get",
  "application": "a2e433a0-ab1a-11e2-a134-85fca932f094",
  "params": {
    "_": [
      "1369888014456"
    ]
  },
  "uri": "http://api.easemob.com/easemob/qixin",
  "entities": [],
  "data": {
    "admin": {
      "type": "role",
      "name": "admin",
      "roleName": null,
      "title": "Administrator",
      "inactivity": 0
    },
    "test-employee": {
      "type": "role",
      "name": "test-employee",
      "roleName": null,
      "title": "test-employee",
      "inactivity": 0
    }
  },
  "timestamp": 1369888014708,
  "duration": 6,
  "organization": "easemob",
  "applicationName": "qixin"
}
</code></pre>

<p>同样的, 也可以通过 /roles/${role_name}/users or groups 来查看某一个role下面有哪些user或者group</p>

<pre><code>delete /roles/${role_name}/users/${username}

撤销一个user所拥有的某项role
</code></pre>

<p>Permission examples</p>

<p>Here are some examples to illustrate how permissions are specified:</p>

<p>A permission to create a user:</p>

<pre><code>post:/users/*
</code></pre>

<p>A permission that allows someone to look at a specific user:</p>

<pre><code>get:/users/john.doe
</code></pre>

<p>A permission that allows the current user to see his activity feed:</p>

<pre><code>get:/users/${user}/feed/*
</code></pre>

<p>The ${user} in the entity path refers to a variable that represents the current user’s UUID.</p>

<p>A permission allowing linked entities to be read:</p>

<pre><code>get:/users/${user}/**
</code></pre>

<p>The /** in the entity path is a wildcard that matches everything under that path. This means that the full specification matches multiple resource paths, including, but not limited to, the following:</p>

<pre><code>/users/${user}/feed
/users/${user}/feed/item1/a/b/c
</code></pre>

<p>A permission that allows the current user to add himself or another user to a group:</p>

<pre><code>post:/groups/${user}/users/**
</code></pre>


    </div>
  </div>
</div><footer class="bs-footer" role="contentinfo">
      <div class="container">
        <p class="text-muted">
          做中国最好的BaaS
        </p>
      </div>
    </footer>
    <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
    <script src="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <script src="http://cdn.bootcss.com/holder/2.0/holder.min.js"></script>
    <script src="http://cdn.bootcss.com/highlight.js/7.3/highlight.min.js"></script>
    <script type="text/javascript">
      hljs.initHighlightingOnLoad();
    </script>
    <script src="/assets/js/application.js"></script>
  </body>
</html>